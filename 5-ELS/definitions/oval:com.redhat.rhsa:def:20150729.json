{
  "class": "patch",
  "id": "oval:com.redhat.rhsa:def:20150729",
  "version": "640",
  "metadata": {
    "title": "RHSA-2015:0729: setroubleshoot security update (Important)",
    "affected": {
      "family": "unix",
      "platform": [
        "Red Hat Enterprise Linux 5",
        "Red Hat Enterprise Linux 6",
        "Red Hat Enterprise Linux 7"
      ]
    },
    "reference": [
      {
        "ref_id": "RHSA-2015:0729",
        "ref_url": "https://access.redhat.com/errata/RHSA-2015:0729",
        "source": "RHSA"
      },
      {
        "ref_id": "CVE-2015-1815",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2015-1815",
        "source": "CVE"
      }
    ],
    "description": "The setroubleshoot packages provide tools to help diagnose SELinux\nproblems. When Access Vector Cache (AVC) messages are returned, an alert\ncan be generated that provides information about the problem and helps to\ntrack its resolution.\n\nIt was found that setroubleshoot did not sanitize file names supplied in a\nshell command look-up for RPMs associated with access violation reports.\nAn attacker could use this flaw to escalate their privileges on the system\nby supplying a specially crafted file to the underlying shell command.\n(CVE-2015-1815)\n\nRed Hat would like to thank Sebastian Krahmer of the SUSE Security Team for\nreporting this issue.\n\nAll setroubleshoot users are advised to upgrade to these updated packages,\nwhich contain a backported patch to correct this issue.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Important",
      "rights": "Copyright 2015 Red Hat, Inc.",
      "issued": {
        "date": "2015-03-26"
      },
      "updated": {
        "date": "2015-03-26"
      },
      "cve": [
        {
          "text": "CVE-2015-1815",
          "href": "https://access.redhat.com/security/cve/CVE-2015-1815",
          "impact": "important",
          "public": "20150326",
          "cwe": "CWE-77",
          "cvss_2": "6.8/AV:N/AC:M/Au:N/C:P/I:P/A:P"
        }
      ],
      "bugzilla": [
        {
          "text": "CVE-2015-1815 setroubleshoot: command injection via crafted file name",
          "href": "https://bugzilla.redhat.com/1203352",
          "id": "1203352"
        }
      ],
      "affected_cpe_list": {
        "cpe": [
          "cpe:/o:redhat:enterprise_linux:5",
          "cpe:/o:redhat:enterprise_linux:5::client",
          "cpe:/o:redhat:enterprise_linux:5::server",
          "cpe:/o:redhat:enterprise_linux:6",
          "cpe:/o:redhat:enterprise_linux:6::client",
          "cpe:/o:redhat:enterprise_linux:6::server",
          "cpe:/o:redhat:enterprise_linux:6::workstation",
          "cpe:/o:redhat:enterprise_linux:7",
          "cpe:/o:redhat:enterprise_linux:7::client",
          "cpe:/o:redhat:enterprise_linux:7::server",
          "cpe:/o:redhat:enterprise_linux:7::workstation"
        ]
      }
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729001",
                    "comment": "setroubleshoot is earlier than 0:2.0.5-7.el5_11"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20080061004",
                    "comment": "setroubleshoot is signed with Red Hat redhatrelease key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729003",
                    "comment": "setroubleshoot-server is earlier than 0:2.0.5-7.el5_11"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20080061006",
                    "comment": "setroubleshoot-server is signed with Red Hat redhatrelease key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.rhba:tst:20070331005",
            "comment": "Red Hat Enterprise Linux 5 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729006",
                    "comment": "setroubleshoot is earlier than 0:3.0.47-6.el6_6.1"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729007",
                    "comment": "setroubleshoot is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729008",
                    "comment": "setroubleshoot-doc is earlier than 0:3.0.47-6.el6_6.1"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729009",
                    "comment": "setroubleshoot-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729010",
                    "comment": "setroubleshoot-server is earlier than 0:3.0.47-6.el6_6.1"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729011",
                    "comment": "setroubleshoot-server is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.rhsa:tst:20100889023",
            "comment": "Red Hat Enterprise Linux 6 is installed"
          }
        ]
      },
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729013",
                    "comment": "setroubleshoot is earlier than 0:3.2.17-4.1.el7_1"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729007",
                    "comment": "setroubleshoot is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729014",
                    "comment": "setroubleshoot-server is earlier than 0:3.2.17-4.1.el7_1"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20150729011",
                    "comment": "setroubleshoot-server is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.rhsa:tst:20140741012",
            "comment": "Red Hat Enterprise Linux 7 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.rhba:tst:20070331006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
