{
  "class": "patch",
  "id": "oval:com.redhat.rhsa:def:20081017",
  "version": "647",
  "metadata": {
    "title": "RHSA-2008:1017: kernel security and bug fix update (Important)",
    "affected": {
      "family": "unix",
      "platform": [
        "Red Hat Enterprise Linux 5"
      ]
    },
    "reference": [
      {
        "ref_id": "RHSA-2008:1017",
        "ref_url": "https://access.redhat.com/errata/RHSA-2008:1017",
        "source": "RHSA"
      },
      {
        "ref_id": "CVE-2008-3831",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2008-3831",
        "source": "CVE"
      },
      {
        "ref_id": "CVE-2008-4554",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2008-4554",
        "source": "CVE"
      },
      {
        "ref_id": "CVE-2008-4576",
        "ref_url": "https://access.redhat.com/security/cve/CVE-2008-4576",
        "source": "CVE"
      }
    ],
    "description": "The kernel packages contain the Linux kernel, the core of any Linux\noperating system.\n\n* Olaf Kirch reported a flaw in the i915 kernel driver. This flaw could,\npotentially, lead to local privilege escalation. Note: the flaw only\naffects systems based on the Intel G33 Express Chipset and newer.\n(CVE-2008-3831, Important)\n\n* Miklos Szeredi reported a missing check for files opened with O_APPEND in\nthe sys_splice(). This could allow a local, unprivileged user to bypass the\nappend-only file restrictions. (CVE-2008-4554, Important)\n\n* a deficiency was found in the Linux kernel Stream Control Transmission\nProtocol (SCTP) implementation. This could lead to a possible denial of\nservice if one end of a SCTP connection did not support the AUTH extension.\n(CVE-2008-4576, Important)\n\nIn addition, these updated packages fix the following bugs:\n\n* on Itanium® systems, when a multithreaded program was traced using the\ncommand \"strace -f\", messages such as\n \n   PANIC: attached pid 10740 exited \n   PANIC: handle_group_exit: 10740 leader 10721\n   ...\n\nwill be displayed, and after which the trace would stop.  With these\nupdated packages, \"strace -f\" command no longer results in these error\nmessages, and strace terminates normally after tracing all threads.\n\n* on big-endian systems such as PowerPC, the getsockopt() function\nincorrectly returned 0 depending on the parameters passed to it when the\ntime to live (TTL) value equaled 255.\n\n* when using an NFSv4 file system, accessing the same file with two\nseparate processes simultaneously resulted in the NFS client process\nbecoming unresponsive.\n\n* on AMD64 and Intel® 64 hypervisor-enabled systems, when a syscall\ncorrectly returned '-1' in code compiled on Red Hat Enterprise Linux 5, the\nsame code, when run with the strace utility, would incorrectly return an\ninvalid return value. This has been fixed: on AMD64 and Intel® 64\nhypervisor-enabled systems, syscalls in compiled code return the same,\ncorrect values as syscalls run with strace.\n\n* on the Itanium® architecture, fully-virtualized guest domains created\nusing more than 64 GB of memory caused other guest domains not to receive\ninterrupts. This caused soft lockups on other guests. All guest domains are\nnow able to receive interrupts regardless of their allotted memory.\n\n* when user-space used SIGIO notification, which was not disabled before\nclosing a file descriptor and was then re-enabled in a different process,\nan attempt by the kernel to dereference a stale pointer led to a kernel\ncrash. With this fix, such a situation no longer causes a kernel crash.\n\n* modifications to certain pages made through a memory-mapped region could\nhave been lost in cases when the NFS client needed to invalidate the page\ncache for that particular memory-mapped file.\n\n* fully-virtualized Windows® guests became unresponsive due to the vIOSAPIC\ncomponent being multiprocessor-unsafe. With this fix, vIOSAPIC is\nmultiprocessor-safe and Windows guests do not become unresponsive.\n\n* on certain systems, keyboard controllers could not withstand continuous\nrequests to switch keyboard LEDs on or off. This resulted in some or all\nkey presses not being registered by the system.\n\n* on the Itanium® architecture, setting the \"vm.nr_hugepages\" sysctl\nparameter caused a kernel stack overflow resulting in a kernel panic, and\npossibly stack corruption. With this fix, setting vm.nr_hugepages works\ncorrectly.\n\n* hugepages allow the Linux kernel to utilize the multiple page size\ncapabilities of modern hardware architectures. In certain configurations,\nsystems with large amounts of memory could fail to allocate most of this\nmemory for hugepages even if it was free. This could result, for example,\nin database restart failures.\n\nUsers should upgrade to these updated packages, which contain backported\npatches to correct these issues.",
    "advisory": {
      "from": "secalert@redhat.com",
      "severity": "Important",
      "rights": "Copyright 2008 Red Hat, Inc.",
      "issued": {
        "date": "2008-12-16"
      },
      "updated": {
        "date": "2008-12-16"
      },
      "cve": [
        {
          "text": "CVE-2008-3831",
          "href": "https://access.redhat.com/security/cve/CVE-2008-3831",
          "impact": "important",
          "public": "20081017"
        },
        {
          "text": "CVE-2008-4554",
          "href": "https://access.redhat.com/security/cve/CVE-2008-4554",
          "impact": "important",
          "public": "20081009"
        },
        {
          "text": "CVE-2008-4576",
          "href": "https://access.redhat.com/security/cve/CVE-2008-4576",
          "impact": "important",
          "public": "20080918"
        }
      ],
      "bugzilla": [
        {
          "text": "CVE-2008-3831 kernel: i915 kernel drm driver arbitrary ioremap",
          "href": "https://bugzilla.redhat.com/464502",
          "id": "464502"
        },
        {
          "text": "CVE-2008-4576 kernel: sctp: Fix oops when INIT-ACK indicates that peer doesn't support AUTH",
          "href": "https://bugzilla.redhat.com/466079",
          "id": "466079"
        },
        {
          "text": "CVE-2008-4554 kernel: don't allow splice() to files opened with O_APPEND",
          "href": "https://bugzilla.redhat.com/466707",
          "id": "466707"
        }
      ],
      "affected_cpe_list": {
        "cpe": [
          "cpe:/o:redhat:enterprise_linux:5",
          "cpe:/o:redhat:enterprise_linux:5::client",
          "cpe:/o:redhat:enterprise_linux:5::server"
        ]
      }
    }
  },
  "criteria": {
    "operator": "OR",
    "criterias": [
      {
        "operator": "AND",
        "criterias": [
          {
            "operator": "OR",
            "criterions": [
              {
                "test_ref": "oval:com.redhat.rhsa:tst:20081017025",
                "comment": "kernel earlier than 0:2.6.18-92.1.22.el5 is currently running"
              },
              {
                "test_ref": "oval:com.redhat.rhsa:tst:20081017026",
                "comment": "kernel earlier than 0:2.6.18-92.1.22.el5 is set to boot up on next boot"
              }
            ]
          },
          {
            "operator": "OR",
            "criterias": [
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017001",
                    "comment": "kernel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314002",
                    "comment": "kernel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017003",
                    "comment": "kernel-PAE is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314004",
                    "comment": "kernel-PAE is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017005",
                    "comment": "kernel-PAE-devel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314006",
                    "comment": "kernel-PAE-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017007",
                    "comment": "kernel-debug is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314008",
                    "comment": "kernel-debug is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017009",
                    "comment": "kernel-debug-devel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314010",
                    "comment": "kernel-debug-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017011",
                    "comment": "kernel-devel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314012",
                    "comment": "kernel-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017013",
                    "comment": "kernel-doc is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314014",
                    "comment": "kernel-doc is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017015",
                    "comment": "kernel-headers is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314016",
                    "comment": "kernel-headers is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017017",
                    "comment": "kernel-kdump is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314018",
                    "comment": "kernel-kdump is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017019",
                    "comment": "kernel-kdump-devel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314020",
                    "comment": "kernel-kdump-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017021",
                    "comment": "kernel-xen is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314022",
                    "comment": "kernel-xen is signed with Red Hat redhatrelease2 key"
                  }
                ]
              },
              {
                "operator": "AND",
                "criterions": [
                  {
                    "test_ref": "oval:com.redhat.rhsa:tst:20081017023",
                    "comment": "kernel-xen-devel is earlier than 0:2.6.18-92.1.22.el5"
                  },
                  {
                    "test_ref": "oval:com.redhat.rhba:tst:20080314024",
                    "comment": "kernel-xen-devel is signed with Red Hat redhatrelease2 key"
                  }
                ]
              }
            ]
          }
        ],
        "criterions": [
          {
            "test_ref": "oval:com.redhat.rhba:tst:20070331005",
            "comment": "Red Hat Enterprise Linux 5 is installed"
          }
        ]
      }
    ],
    "criterions": [
      {
        "test_ref": "oval:com.redhat.rhba:tst:20070331006",
        "comment": "Red Hat Enterprise Linux must be installed"
      }
    ]
  }
}
